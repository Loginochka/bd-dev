# Домашнее задание к занятию 1. «Типы и структура СУБД» - Логиноа Даниил

### Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определённых данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

* электронные чеки в json-виде,
* склады и автомобильные дороги для логистической компании,
* генеалогические деревья,
* кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации,
* отношения клиент-покупка для интернет-магазина.

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

### Ответ 1

1. **Электронные чеки в JSON-виде:**
Документоориентированные базы данных (например, MongoDB).
Хорошо подходят для хранения JSON-подобных данных, таких как электронные чеки. Они обеспечивают гибкую схему данных, что полезно при изменении формата чеков.

2. **Склады и автомобильные дороги для логистической компании:**
Пространственные базы данных (например, PostGIS с PostgreSQL).
Предназначены для эффективного хранения и запросов географических данных, таких как информация о складах и дорогах.

3. **Генеалогические деревья:**
Графовые базы данных (например, Neo4j).
Подходят для представления и обработки сложных взаимосвязей в генеалогических деревьях, где каждый узел представляет члена семьи, а связи — родственные отношения.

4. **Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутентификации:**
Ключ-значение (например, Redis).
БД такие как Redis, обеспечивают быстрый доступ к данным по ключу, что подходит для хранения кэша идентификаторов с ограниченным временем жизни.

5. **Отношения клиент-покупка для интернет-магазина:**
Реляционные базы данных (например, MySQL, PostgreSQL).
Хорошо подходят для хранения структурированных данных с четкими отношениями между ними, таких как информация о клиентах и их покупках в интернет-магазине.

### Задание 2

Вы создали распределённое высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если (каждый пункт — это отдельная реализация вашей системы и для каждого пункта нужно привести классификацию):

* данные записываются на все узлы с задержкой до часа (асинхронная запись);
* при сетевых сбоях система может разделиться на 2 раздельных кластера;
* система может не прислать корректный ответ или сбросить соединение.

Согласно PACELC-теореме как бы вы классифицировали эти реализации?

### Ответ 2

Согласно CAP-теореме, системы распределённого хранения данных могут обеспечивать не более двух из трех свойств: согласованность (Consistency), доступность (Availability) и устойчивость к разделению (Partition Tolerance). С учетом этих свойств:

1. **Данные записываются на все узлы с задержкой до часа (асинхронная запись):**
**Классификация: CP (Consistency, Partition Tolerance).**
Задержка до часа и синхронизированная запись на все узлы означают, что система стремится к согласованности, даже за счет доступности в случае возможных разделений.

2. **При сетевых сбоях система может разделиться на 2 раздельных кластера:**
**Классификация: AP (Availability, Partition Tolerance).**
В условиях сетевых сбоев система приоритетно обеспечивает доступность и разделение кластеров для сохранения работы в условиях сетевых разделений.

3. **Система может не прислать корректный ответ или сбросить соединение:**
**Классификация: CP (Consistency, Partition Tolerance).**
В данном случае, система снова предпочитает согласованность, отказываясь от доступности в случае возможных разделений или проблем с корректностью ответов.

Классификация согласно PACELC-теореме:

**PACELC:**

**P (Partitiontolerance):** Все реализации являются partition-tolerant, так как это требование CAP-теоремы.

**A (Availability):** Вторая реализация (разделение на 2 кластера) стремится к высокой доступности в ущерб согласованности.

**C (Consistency):** Первая и третья реализации стремятся к согласованности, но с разной степенью доступности.

**E (Latency):** Все реализации имеют различную степень задержки, но этот аспект не учитывается в PACELC-теореме.

Таким образом, с учетом PACELC-теоремы:

**Первая реализация:** PAC (Partition Tolerance, Availability, Consistency)
**Вторая реализация:** PAV (Partition Tolerance, Availability, Varying Consistency)
**Третья реализация:** PC (Partition Tolerance, Consistency)

### Задание 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

### Ответ 3

Принципы BASE и ACID представляют собой различные подходы к управлению транзакциями и обеспечению надежности в распределённых системах. В общем случае, системы могут комбинировать элементы обоих подходов в зависимости от своих требований и характеристик.

Многие современные распределенные системы стремятся к гибридному подходу, включая элементы как ACID, так и BASE, чтобы соответствовать требованиям разнообразных сценариев использования. Это может включать в себя использование ACID для критически важных частей системы (например, управление счетами клиентов), а для менее критичных операций (например, чтение данных) применять принципы BASE для обеспечения более высокой доступности и масштабируемости.

### Задание 4

Вам дали задачу написать системное решение, основой которого бы послужили:

* фиксация некоторых значений с временем жизни,
* реакция на истечение таймаута.

Вы слышали о key-value-хранилище, которое имеет механизм Pub/Sub. Что это за система? Какие минусы выбора этой системы?

### Ответ 4

Под данное описание подходят Redis, которое является in-memory key-value хранилищем с механизмом Pub/Sub (публикации/подписки).

**Key-Value Хранилище:** Redis хранит данные в виде ключей и соответствующих им значений, где значения могут быть строками, хэшами, списками, множествами и другими структурами данных.
**Время жизни ключа (TTL):** В Redis можно устанавливать время жизни для ключей с помощью механизма TTL. Ключ будет автоматически удален после истечения указанного времени.
**Механизм Pub/Sub:** Redis поддерживает Pub/Sub, что позволяет различным частям системы (клиентам) подписываться на определенные события (публикации) и реагировать на них.

Минусы выбора Redis с Pub/Sub:

1. Ограничения по объему данных: Redis хорошо подходит для хранения относительно небольших объемов данных в оперативной памяти. Если объем данных слишком велик, это может привести к проблемам с производительностью или требовать большего объема оперативной памяти.
2. Сложности в горизонтальном масштабировании: В отличие от некоторых других хранилищ данных, горизонтальное масштабирование Redis может быть сложным.
3. Отсутствие некоторых продвинутых функциональностей: В некоторых случаях, например, когда требуется сложная аналитика или операции с данными, Redis может оказаться менее подходящим выбором.
4. Устаревшие данные в случае сбоев: В случае сбоя Redis, данные, не записанные на диск (в случае использования в режиме сохранения на диск), могут быть утеряны, что приведет к потере нефиксированных значений.
